How to Serve a Single Table
===========================
``` JSON
	{
		"Section": "TabServer"
	,	"SubSection": "Serve A Table"
	,	"SubSectionGroup": "Config"
	,	"SubSectionTitle": "Serve data from a table"
	,	"SubSectionTooltip": "How to configure to serve and update data in a single table"
	, 	"MultiSection":2
	}
```




## Create the table - or pic a table to use

Create tables in the database.  In this case we are going to create a table called `feedback` in PostgreSQL.
The file for this can be found in ./example/feedback.sql.

``` bash
	$ cd ./example
	$ psql -a -P pager=off -h 127.0.0.1 -U pschlump <feedback.sql
```


## How to serve a table

Now create the example `sql-cfg.json` file:

``` bash
	$ cd ../tools/genDefault
	$ go run ./main.go feedback >sample.out
	$ cat sample.out
```

should give you in sample.out

``` JSON
	{
		"note:generated":"Tables: [feedback]", 

		,"/api/table/feedback": { "crud": [ "select", "insert", "update", "delete", "info" ]
			, "Comment": "Generated by genDefault"
			, "TableName": "feedback"
			, "LineNo":"__LINE__"
			, "Method":["GET","POST","PUT","DELETE"]
			, "cols": [
				  { "colName": "id"      , "colType": "s",	               "insert":true, "autoGen":true, "isPk": true }
				, { "colName": "subject" , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "body"    , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "status"  , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "updated" , "colType": "t",	"update":true, "insert":true		}
				, { "colName": "created" , "colType": "t",	"update":true, "insert":true		}
				]
			}
	}
```

You may want to make the last 2 columns read only as they get generated in the database.  This gives you:

``` JSON
	{
		"note:generated":"Tables: [feedback]", 

		,"/api/table/feedback": { "crud": [ "select", "insert", "update", "delete", "info" ]
			, "Comment": "Generated by genDefault"
			, "TableName": "feedback"
			, "LineNo":"__LINE__"
			, "Method":["GET","POST","PUT","DELETE"]
			, "cols": [
				  { "colName": "id"      , "colType": "s",	               "insert":true, "autoGen":true, "isPk": true }
				, { "colName": "subject" , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "body"    , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "status"  , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "updated" , "colType": "t",                                      }
				, { "colName": "created" , "colType": "t",                                      }
				]
			}
	}
```

Copy the modified file into the `./test-sql-cfg/` as `sql-cfg.json` or modify an existing `sql-cfg.json` file and add the 
lines from `,"/api...` down to the matching `}`.

## Add to your config

This is a sample of the configuration file for the server.  The above file is put in ./test-sql-cfg/ as sql-cfg.json

``` JSON
	{
		"working_test_AngularJS_20": { "LineNo":__LINE__,
			"listen_to":[ "http://localhost:16000" ],
			"plugins":[
				{ "TabServer2": { "LineNo":__LINE__,
					"Paths":["/api/"],
					"AppName": "www.2c-why.com",
					"AppRoot": "./test-sql-cfg/",
					"StatusMessage":"Version 0.0.1 Thu Apr 21 07:44:42 MDT 2016"
				} },
				{ "file_server": { "LineNo":__LINE__, "Root":"./quickstart", "Paths":"/"  } }
			]
		}
	}
```

Restart the server and then we can test it.

## test it...

To test it use a browser or some other tool that can fetch from localhost (wget, curl for example).
In the browser enter the URL `http://localhost:16000/api/table/feedback` to perform a GET on this end point.

![example output from fetching data](https://github.com/pschlump/TabServer2/raw/master/img/example.png "example output")



## turn on security for table if you need it/want it.

To require login before changing the data you will need to change `, "LoginRequired":false` to `, "LoginRequired":true`
as is shown below:

``` JSON
	{
		"note:generated":"Tables: [feedback]", 

		,"/api/table/feedback": { "crud": [ "select", "insert", "update", "delete", "info" ]
			, "Comment": "Generated by genDefault"
			, "TableName": "feedback"
			, "LineNo":"__LINE__"
			, "LoginRequired":true
			, "Method":["GET","POST","PUT","DELETE"]
			, "cols": [
				  { "colName": "id"      , "colType": "s",	               "insert":true, "autoGen":true, "isPk": true }
				, { "colName": "subject" , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "body"    , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "status"  , "colType": "s",	"update":true, "insert":true		}
				, { "colName": "updated" , "colType": "t",                                      }
				, { "colName": "created" , "colType": "t",                                      }
				]
			}
	}
```

And then include some form of login, for example the `SrpAesAuth` authentication:

``` JSON
	{
		"working_test_AngularJS_20": { "LineNo":__LINE__,
			"listen_to":[ "http://localhost:16000" ],
			"plugins":[
				{ "SrpAesAuth": { "LineNo":__LINE__,
					"Paths": "/api/" ,
					"MatchPaths": [ "/api/table/", "/api/list" ]
				} },
				{ "TabServer2": { "LineNo":__LINE__,
					"Paths":["/api/"],
					"AppName": "www.2c-why.com",
					"AppRoot": "./test-sql-cfg/",
					"StatusMessage":"Version 0.0.1 Thu Apr 21 07:44:42 MDT 2016"
				} },
				{ "file_server": { "LineNo":__LINE__, "Root":"./quickstart", "Paths":"/"  } }
			]
		}
	}
```

Then restart the server or have the server re-load the configuration file.  Login is now required to access
the table.  This means that you will have to authenticate, use two factor authentication and make requests using the
`/api/cipher` interface with fully encrypted messages.  Take a look at one of the authentication/login examples.


## data field names fail to match column names in the table

Suppose that you have data that is incoming called "subject" but the column in the table is called "title".
You can still match it up by using the `DataColName` option.

``` JSON
	...
	,"/api/table/contact": { "crud": [ "select", "insert", "update", "delete", "info" ]
		, "Comment": "Save Contact Requests"
		, "TableName": "p_issue"
		, "LineNo":"__LINE__"
		, "LoginRequired":false
		, "Method":["GET","POST","PUT","DELETE"]
		, "ReturnMeta":false
		, "ReturnAsHash":true
		, "cols": [
			  { "colName": "id"    		 , "colType": "s",	               "insert":true, "autoGen":true, "isPk":true 	}
			, { "colName": "title"	 	 , "colType": "s",	"update":true, "insert":true						, "DataColName":"subject"		}
			, { "colName": "desc"		 , "colType": "s",	"update":true, "insert":true								}
			, { "colName": "type_group"	 , "colType": "s",	"update":true, "insert":true, "default":"contact"			}
			]
		}
	...

```



