Anti-CSRF Tokens
The most popular implementation to prevent Cross-site Request Forgery (CSRF), is to make use of a challenge token that is associated with a particular user and can be found as a hidden value in every state changing form which is present on the web application. This token, called a CSRF Token or a Synchronizer Token, works as follows:

The web server generates a token
The token is statically set as a hidden input on the protected form
The form is submitted by the user
The token is included in the POST data
The web application compares the token generated by the web application with the token sent in through the request
If these tokens match, the request is valid, as it has been sent through the actual form in the web application
If there is no match, the request will be considered as illegal and will be rejected.
This protects the form against Cross-site Request Forgery (CSRF) attacks, because an attacker crafting a request will also need to guess the anti-CSRF token for them to successfully trick a victim into sending a valid request. Whatâ€™s more, is that this token should be invalidated after some time and after the user logs out.

For the anti-CSRF mechanism to be implemented properly, it will also need to be cryptographically secure, so that the token itself cannot be easily guessed, which is a possibility if the token is being generated based on a predictable pattern.



